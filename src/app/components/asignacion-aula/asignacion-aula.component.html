<div class="page-container asignacion-container">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <div class="header">
      <h1 class="welcome">¬°Bienvenido/a, <span class="user-name">{{ currentUser }}</span>!</h1>
    </div>

    <div class="content-area">
      <h2 class="page-title">ASIGNACION DE AULA</h2>

      <div class="form-container">
        <!-- Formulario de Asignaci√≥n -->
        <div class="form-section">
          <div class="section-header">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="section-icon">
              <path d="M10 10C12.7614 10 15 7.76142 15 5C15 2.23858 12.7614 0 10 0C7.23858 0 5 2.23858 5 5C5 7.76142 7.23858 10 10 10Z" fill="currentColor"/>
              <path d="M10 12C5.58172 12 2 15.5817 2 20H18C18 15.5817 14.4183 12 10 12Z" fill="currentColor"/>
            </svg>
            <h3 class="section-title">Nueva Asignaci√≥n de Aula</h3>
          </div>
          
          <div class="form-fields">
            <div class="form-field">
              <label>Usuario *</label>
              <select [(ngModel)]="nuevoUsuarioId" class="form-input" required>
  <option [ngValue]="null">Seleccione un usuario</option>
  <option *ngFor="let usuario of usuarios" [ngValue]="usuario.idUsuario">
    {{ usuario.nombre }} ({{ usuario.email }})
  </option>
</select>
            </div>
            
            <div class="form-field">
              <label>Aula *</label>
              <select [(ngModel)]="nuevaAulaId" class="form-input" required>
                <option [ngValue]="null">Seleccione un aula</option>
                <option *ngFor="let aula of getAulasDisponibles()" [ngValue]="aula.idAula">
                  {{ aula.nombre }} - {{ aula.ubicacion }} (Capacidad: {{ aula.capacidad }})
                </option>
              </select>
            </div>

            <div class="form-field">
              <label>Fecha de Solicitud</label>
              <input 
                type="date" 
                [(ngModel)]="nuevaFecha"
                class="form-input"
                  [min]="fechaHoy"

                [max]="fechaHoy"
  required>
            </div>
          </div>
        </div>
      </div>

      <!-- Bot√≥n Registrar -->
      <div class="action-button-container">
        <button class="btn-registrar" (click)="registrarAsignacion()">
          Registrar Asignaci√≥n
        </button>
      </div>
<!-- ALERTA MODERNA -->
<div class="alert-overlay" *ngIf="mostrarAlerta">
  <div class="alert-box" [ngClass]="tipoAlerta">

    <div class="alert-icon">
      {{ tipoAlerta === 'success' ? '‚úì' : '!' }}
    </div>

    <h3>{{ tituloAlerta }}</h3>
    <p>{{ mensajeAlerta }}</p>

    <button class="btn-alert" (click)="mostrarAlerta = false">
      Entendido
    </button>

  </div>
</div>


      <!-- Lista de Asignaciones -->
      <div class="asignaciones-list" *ngIf="asignaciones.length > 0">
        <h3 class="list-title">Asignaciones Existentes</h3>
        <div class="table-container">
          <table class="asignaciones-table">
            <thead>
              <tr>
                <th>Usuario</th>
                <th>Aula</th>
                <th>Fecha Solicitud</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
           <tbody>
  <tr *ngFor="let asignacion of asignaciones">
    <td>{{ asignacion.usuario.nombre }}</td>
    <td>{{ asignacion.aula.nombre }} - {{ asignacion.aula.ubicacion }}</td>
<td>
  {{ asignacion.fechaSolicitud | date:'dd/MM/yyyy' }}
</td>


    <td>
      <span 
        class="status-badge"
        [class.active]="asignacion.estado"
        [class.inactive]="!asignacion.estado">
        {{ asignacion.estado ? 'Activa' : 'Inactiva' }}
      </span>
    </td>
    <td class="actions">
      <button class="btn-edit" (click)="openEditModal(asignacion)">
        ‚úèÔ∏è
      </button>
      <button class="btn-delete" (click)="eliminarAsignacion(asignacion.idAsignacion)">
        üóëÔ∏è
      </button>
    </td>
  </tr>
</tbody>

          </table>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="modal-overlay" *ngIf="showEditModal">
  <div class="modal-content">

    <h2>Editar Asignaci√≥n</h2>

    <div class="form-field">
      <label>Usuario</label>
      <select [(ngModel)]="editUsuarioId">
        <option *ngFor="let usuario of usuarios"
                [value]="usuario.idUsuario">
          {{ usuario.nombre }}
        </option>
      </select>
    </div>

    <div class="form-field">
      <label>Aula</label>
      <select [(ngModel)]="editAulaId">
        <option *ngFor="let aula of aulas"
                [value]="aula.idAula">
          {{ aula.nombre }} - {{ aula.ubicacion }}
        </option>
      </select>
    </div>

    <div class="form-field">
      <label>Fecha</label>
      <input
  type="date"
  [(ngModel)]="editFecha"
  name="editFecha"
  required
/>
    </div>

    <div class="modal-actions">
      <button class="btn-save" (click)="updateAsignacion()">
        Guardar
      </button>
      <button class="btn-cancel" (click)="closeEditModal()">
        Cancelar
      </button>
    </div>

  </div>
</div>


