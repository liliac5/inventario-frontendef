<div class="portal-container">
  <app-sidebar></app-sidebar>

  <div class="main-content">
    <div class="header">
      <h1 class="welcome">¡Bienvenido/a, <span class="user-name">{{ currentUser }}</span>!</h1>
    </div>

    <div class="portal-content">
    <div class="main-title-section">
      <svg width="28" height="28" viewBox="0 0 28 28" fill="none" class="title-icon">
        <path d="M14 2L16 10H24L18 14L20 22L14 18L8 22L10 14L4 10H12L14 2Z" stroke="currentColor" stroke-width="2" fill="none"/>
        <rect x="6" y="6" width="16" height="16" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
      </svg>
      <h2 class="main-title">Solicitud de Mantenimiento y Cambio de Aulas</h2>
    </div>

    <div class="content-grid">
      <!-- Sección Crear Nueva Solicitud -->
      <div class="form-section">
        <h3 class="section-title">Crear Nueva Solicitud</h3>
        
        <form (ngSubmit)="enviarSolicitud()">
          <div class="form-group">
  <label for="aula">Aula</label>
<select
  id="aula"
  [(ngModel)]="aulaSeleccionada"
  name="aula"
  required
  (ngModelChange)="onAulaChange()"
>
  <option *ngFor="let aula of aulasAsignadas" [ngValue]="aula.idAula">
    {{ aula.nombre }}
  </option>
</select>

</div>
<div class="form-group">
  <label for="bien">Bien</label>
  <select id="bien" [(ngModel)]="bienSeleccionado" name="bien" required>
   <option *ngFor="let bien of getBienesAsignados()" [ngValue]="bien.idBien">
  {{ bien.nombre_bien }} ({{ bien.aula.nombre }})
</option>

  </select>
</div>

          <div class="form-group">
            <label for="tipo">Tipo de Solicitud</label>
            <select 
              id="tipo"
              name="tipo"
              [(ngModel)]="tipoSolicitud"
              class="form-select"
              required>
              <option value="">Seleccione el tipo</option>
              <option *ngFor="let tipo of tiposSolicitud" [value]="tipo">
                {{ tipo }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="detalle">Detalle del Problema / Requerimiento</label>
            <textarea 
              id="detalle"
              name="detalle"
              [(ngModel)]="detalleProblema"
              class="form-textarea"
              placeholder="Describa el problema o el cambio que necesita..."
              rows="6"
              required></textarea>
          </div>

          <button type="submit" class="btn-enviar">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="envelope-icon">
              <rect x="2" y="4" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <path d="M2 6L10 11L18 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Enviar Solicitud
          </button>
        </form>
      </div>

      <!-- Sección Historial -->
      <div class="history-section">
        <h3 class="section-title">Historial de Mis Solicitudes</h3>
        
        <div class="table-container">
          <table class="solicitudes-table">
            <thead>
              <tr>
                <th>AULA</th>
                <th>TIPO</th>
                <th>DETALLE</th>
                <th>ESTADO</th>
              </tr>
            </thead>
            <tbody>
             <tr *ngFor="let solicitud of misSolicitudes">
     <td>{{ solicitud.bien?.aula?.nombre || 'N/A' }}</td>
<td>{{ solicitud.descripcion.split(':')[0] }}</td>
<td>{{ solicitud.descripcion.split(':').slice(1).join(':') }}</td>

<td><span class="estado-badge pendiente">{{ solicitud.estado }}</span></td>

            </tr>
              <tr *ngIf="misSolicitudes.length === 0">
                <td colspan="4" class="no-data">No hay solicitudes registradas</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

